<div class="main-content">
  <div class="text-center mb-4">
    <h2>Profiles</h2>
  </div>
  <div class="text-center mb-4" *ngIf="currentUserRole !== 'MAIN_ADMIN'">
    <p> If you can't see actions you want to do, then ask {{currentUserRole
      === 'USER' ?
      'main admin or administrator of your faculty or chair' : 'main admin'}}</p>
  </div>

  <div class="mb-3 row d-flex justify-content-between">
    <div [ngClass]="{'col-sm-8' : (hasPermissionForAction('ADD_PROFILES')
    || currentUserRole === 'MAIN_ADMIN'), 'col-sm-12': (!hasPermissionForAction('ADD_PROFILES')
    && currentUserRole !== 'MAIN_ADMIN')}">
      <div>
        <div class="mb-3 d-flex justify-content-between">
          <label class="col-sm-4 col-form-label" for="selectScientometricSystem">Select system: </label>
          <div class="col-sm-8">
            <select class="form-control" id="selectFaculty" name="faculty" [(ngModel)]="selectedScientometricSystem">
              <option *ngFor="let scientometricSystem of scientometricSystems" [value]="scientometricSystem.id">
                {{scientometricSystem.name}}</option>
            </select>
          </div>
        </div>
        <div class="mb-3 d-flex justify-content-between">
          <label class="col-sm-4 col-form-label" for="searchUser">Enter full name: </label>
          <div class="col-sm-8">
            <input class="form-control" type="text" [(ngModel)]="searchQuery" name="searchUser" id="searchUser">
          </div>
        </div>
        <div class="mb-3 d-flex justify-content-between">
          <label class="col-sm-4 col-form-label" for="selectFaculty">Select faculty: </label>
          <div class="col-sm-8">
            <select class="form-control" id="selectFaculty" name="faculty" [(ngModel)]="selectedFaculty">
              <option *ngFor="let faculty of faculties" [value]="faculty.id">
                {{faculty.name}}</option>
            </select>
          </div>
        </div>
        <div class="mb-3 d-flex justify-content-between">
          <label class="col-sm-4 col-form-label" for="selectChair">Select chair: </label>
          <div class="col-sm-8">
            <select class="form-control" id="chairs" name="selectChair" [(ngModel)]="selectedChair">
              <option *ngFor="let chair of displayedChairs" [value]="chair.id">
                {{chair.name}}</option>
            </select>
          </div>
        </div>
        <div class="d-flex justify-content-between">
          <button type="button" class="btn btn-primary btn-block" (click)="clear()">Clear</button>
          <button type="button" class="btn btn-primary btn-block" (click)="search(1)">Search</button>
        </div>
      </div>
    </div>
    <ng-template [ngIf]="hasPermissionForAction('ADD_PROFILES') || currentUserRole === 'MAIN_ADMIN'">
      <div class="col-sm-4 d-flex justify-content-end align-items-center">
        <button type="submit" class="btn btn-primary btn-block" routerLink="/user/profiles/add">Add
          Profile</button>
      </div>
    </ng-template>
  </div>

  <div *ngIf="displayedProfiles.length === 0" class="text-center mb-4">
    <p>No records found</p>
  </div>

  <ng-template [ngIf]="displayedProfiles.length !== 0">
    <div class="mb-3 row justify-content-center align-items-center pd-5 border-content"
      *ngFor="let profile of displayedProfiles">
      <label class="text-center" [ngClass]="{'col-sm-6': true}"> {{profile.scientistName}}</label>
      <div class="col-sm-6 d-flex align-items-center flex-column">
        <button *ngIf="currentUserRole === 'MAIN_ADMIN' && profile.areWorksDoubtful" class="mb-3"
          style="margin-top: 10px; margin-bottom: 10px" type="button" class="btn btn-primary btn-block"
          (click)="unmarkAsDoubtful(profile.id)">Unmark Works Doubtful</button>
        <button *ngIf="currentUserRole === 'MAIN_ADMIN' && !profile.areWorksDoubtful" class="mb-3"
          style="margin-top: 10px; margin-bottom: 10px" type="button" class="btn btn-primary btn-block"
          (click)="markAsDoubtful(profile.id)">Mark Works Doubtful</button>
        <button *ngIf="profile.isActive && (hasPermissionForAction('EDIT_PROFILES')
        || currentUserRole === 'MAIN_ADMIN')" class="mb-3" style="margin-top: 10px; margin-bottom: 10px" type="button"
          class="btn btn-primary btn-block" (click)="goToEditPage(profile.id)">Edit</button>
        <button *ngIf="!profile.isActive && (hasPermissionForAction('DEACTIVATE_PROFILES')
        || currentUserRole === 'MAIN_ADMIN')" class="mb-3" style="margin-top: 10px; margin-bottom: 10px" type="button"
          class="btn btn-primary btn-block" (click)="activate(profile.id)">Activate</button>
        <button *ngIf="profile.isActive && (hasPermissionForAction('DEACTIVATE_PROFILES')
        || currentUserRole === 'MAIN_ADMIN')" class="mb-3" style="margin-top: 10px; margin-bottom: 10px" type="button"
          class="btn btn-primary btn-block" (click)="deactivate(profile.id)">Deactivate</button>
      </div>
    </div>
  </ng-template>

  <app-pagination [currentPage]="currentPage" [totalPages]="totalPages"
    (pageChange)="pageChange($event)"></app-pagination>
</div>
